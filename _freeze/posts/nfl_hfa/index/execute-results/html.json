{
  "hash": "adccfe1c614de4ba43ddd2e1bce20df4",
  "result": {
    "markdown": "---\ntitle: \"NFL Home Field Advantage\"\nexecute: \n  freeze: true\n  eval: true\nformat:\n  html:\n    highlight: true\n    code-fold: show\n    code-tools: true\n    highlight-style: github\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(rstan)\nlibrary(ggrepel)\nlibrary(gghighlight)\nlibrary(gt)\nlibrary(gtExtras)\n\nfuture::plan(\"multisession\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nIf you do not have the data on your local device you can either swap the path with `https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_{x}.rds` or get it via `nflfastR::load_pbp(1999:2021)`. Note that it will take a while since there is over 1 million rows by 366-ish columns, which is why I filter and drop rows straight away. \n\nUsing `{x}` with `glue()` allows us to loop every value input from the `map_df` call into the location. I found this super cool the first time I saw it. This is exactly like f strings in Python if you are familiar with that.\n\n::: {.cell}\n\n```{.r .cell-code}\npbp <- purrr::map_df(c(1999:2021), function(x) {\n  readRDS(\n    glue::glue(\"~/Documents/nfl/data/pbp/play_by_play_{x}.rds\")\n  )}) %>%\n  filter(\n    season_type == 'REG',\n    # drop values that no plays occur\n    # e.g. timeout, halftime, etc.\n    !is.na(posteam_type)\n    ) %>%\n  select(\n    game_id, season, week, posteam_type, season_type, \n    home_team, away_team, home_score, away_score) %>%\n  group_by(game_id) %>%\n  # this will give two rows for each game, one for \n  # the home team, one for the away team\n  #slice(n()) or distinct(game_id, posteam_type, \n  # .keep_all = TRUE) if you only want one observation per row\n  distinct(.keep_all = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# team\nleague_wide_win_team <- pbp %>%\n  distinct(game_id, .keep_all = TRUE) %>%\n  mutate(score_diff = home_score - away_score) %>%\n  group_by(season, home_team) %>%\n  summarise(\n    n = n(),\n    home_win = mean(home_score - away_score > 0),\n    home_points_diff = sum(home_score - away_score)\n  ) %>% ungroup() %>%\n  mutate(\n    mean_point_diff = home_points_diff / n,\n    # so you can plot is sequentially\n    week_n = row_number()\n  ) \n\n#add team colours for plotting\nleague_wide_win_team <- league_wide_win_team %>%\n  left_join(\n    select(\n      nflfastR::teams_colors_logos, \n      home_team = team_abbr, \n      team_name, team_color, \n      team_color2)\n      )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nleague_wide_win_team %>%\n  mutate(\n    #LV colour is grey so I am using their secondary colour here\n    team_color = ifelse(team_color == \"#a5acaf\", \"#000000\", team_color),\n    season_label = paste0(\"'\", substr(season, 3, 4)),\n    season_label = as_factor(season_label)\n    ) %>%\n  ggplot(aes(\n    # the label is a character, so get 99 at the start\n    x = fct_reorder(season_label, season),\n    y = mean_point_diff,\n    colour = team_color,\n    group = home_team,\n  )) +\n  geom_line(size = 1.15) +\n  scale_x_discrete(breaks = paste0(\"'\", seq(1999, 2021, 3) |> substr(3, 4))) +\n  gghighlight(use_direct_label = FALSE, keep_scales = TRUE) +\n  scale_color_identity(aesthetics = c(\"color\", \"fill\")) +\n  facet_wrap(~home_team, scales = \"free\", ncol = 5L) +\n  labs(\n    x = \"Season\",\n    y = \"HFA\",\n    title = \"HFA By Team\",\n    subtitle = \"Regular Season, 1999:2021\",\n    caption = \"data: nflfastR\"\n  ) +\n  becausejustynfun::white_theme() +\n  theme(axis.text = element_text(size = 6))\n```\n:::\n\n\n::: {.column-screen}\n![A full screen image](plots/league_wide_win_team.jpg)\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nleague_wide_win_team %>%\n  ggplot(aes(\n    x = factor(season), \n    y = mean_point_diff, \n    group = 1)) +\n  geom_line(aes(group = factor(home_team)), alpha = 0.5) + \n  geom_line(stat = 'summary', fun = 'mean', colour = 'blue', size = 1) +\n  scale_y_continuous(breaks = seq(-22, 24, 4)) +\n  scale_x_discrete(labels = paste0(\"'\", substr(c(1999:2021), 3, 4))) +\n  labs(\n    x = \"Season\",\n    y = \"HFA\",\n    title = \"Home Field Advantage\",\n    subtitle = \"Regular Season, 1999:2021\",\n    caption = \"data: nflfastR \\nBlue line is the mean HFA by season.\"\n  ) +\n  theme(axis.text.x = element_text(angle = 15, hjust = 1)) +\n  hrbrthemes::theme_ft_rc()\n```\n:::\n\n\n::: {.column-screen}\n![A full screen image](plots/league_wide_win_league.jpg)\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- lm(mean_point_diff ~ factor(season), data = league_wide_win_team)\n\ntidy(mod) %>% \n  gt() %>% \n  fmt_number(\n    columns = c(2:5), \n    decimals = 3)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"zvyithxkjo\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#zvyithxkjo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zvyithxkjo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zvyithxkjo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zvyithxkjo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zvyithxkjo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zvyithxkjo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zvyithxkjo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zvyithxkjo .gt_group_heading {\n  padding: 8px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zvyithxkjo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zvyithxkjo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zvyithxkjo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zvyithxkjo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zvyithxkjo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 12px;\n}\n\n#zvyithxkjo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zvyithxkjo .gt_first_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zvyithxkjo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zvyithxkjo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding: 4px;\n}\n\n#zvyithxkjo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zvyithxkjo .gt_sourcenote {\n  font-size: 90%;\n  padding: 4px;\n}\n\n#zvyithxkjo .gt_left {\n  text-align: left;\n}\n\n#zvyithxkjo .gt_center {\n  text-align: center;\n}\n\n#zvyithxkjo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zvyithxkjo .gt_font_normal {\n  font-weight: normal;\n}\n\n#zvyithxkjo .gt_font_bold {\n  font-weight: bold;\n}\n\n#zvyithxkjo .gt_font_italic {\n  font-style: italic;\n}\n\n#zvyithxkjo .gt_super {\n  font-size: 65%;\n}\n\n#zvyithxkjo .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 65%;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">(Intercept)</td>\n<td class=\"gt_row gt_right\">3.100</td>\n<td class=\"gt_row gt_right\">1.319</td>\n<td class=\"gt_row gt_right\">2.349</td>\n<td class=\"gt_row gt_right\">0.019</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2000</td>\n<td class=\"gt_row gt_right\">&minus;0.416</td>\n<td class=\"gt_row gt_right\">1.866</td>\n<td class=\"gt_row gt_right\">&minus;0.223</td>\n<td class=\"gt_row gt_right\">0.823</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2001</td>\n<td class=\"gt_row gt_right\">&minus;1.092</td>\n<td class=\"gt_row gt_right\">1.866</td>\n<td class=\"gt_row gt_right\">&minus;0.585</td>\n<td class=\"gt_row gt_right\">0.559</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2002</td>\n<td class=\"gt_row gt_right\">&minus;0.854</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.461</td>\n<td class=\"gt_row gt_right\">0.645</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2003</td>\n<td class=\"gt_row gt_right\">0.455</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">0.246</td>\n<td class=\"gt_row gt_right\">0.806</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2004</td>\n<td class=\"gt_row gt_right\">&minus;0.592</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.320</td>\n<td class=\"gt_row gt_right\">0.749</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2005</td>\n<td class=\"gt_row gt_right\">0.549</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">0.296</td>\n<td class=\"gt_row gt_right\">0.767</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2006</td>\n<td class=\"gt_row gt_right\">&minus;2.252</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;1.217</td>\n<td class=\"gt_row gt_right\">0.224</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2007</td>\n<td class=\"gt_row gt_right\">&minus;0.232</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.126</td>\n<td class=\"gt_row gt_right\">0.900</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2008</td>\n<td class=\"gt_row gt_right\">&minus;0.541</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.292</td>\n<td class=\"gt_row gt_right\">0.770</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2009</td>\n<td class=\"gt_row gt_right\">&minus;0.893</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.482</td>\n<td class=\"gt_row gt_right\">0.630</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2010</td>\n<td class=\"gt_row gt_right\">&minus;1.205</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.651</td>\n<td class=\"gt_row gt_right\">0.515</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2011</td>\n<td class=\"gt_row gt_right\">0.166</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">0.090</td>\n<td class=\"gt_row gt_right\">0.929</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2012</td>\n<td class=\"gt_row gt_right\">&minus;0.666</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.360</td>\n<td class=\"gt_row gt_right\">0.719</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2013</td>\n<td class=\"gt_row gt_right\">0.006</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">0.003</td>\n<td class=\"gt_row gt_right\">0.997</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2014</td>\n<td class=\"gt_row gt_right\">&minus;0.611</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.330</td>\n<td class=\"gt_row gt_right\">0.741</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2015</td>\n<td class=\"gt_row gt_right\">&minus;1.537</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.830</td>\n<td class=\"gt_row gt_right\">0.407</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2016</td>\n<td class=\"gt_row gt_right\">&minus;0.533</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.288</td>\n<td class=\"gt_row gt_right\">0.773</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2017</td>\n<td class=\"gt_row gt_right\">&minus;0.615</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.332</td>\n<td class=\"gt_row gt_right\">0.740</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2018</td>\n<td class=\"gt_row gt_right\">&minus;0.897</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.484</td>\n<td class=\"gt_row gt_right\">0.628</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2019</td>\n<td class=\"gt_row gt_right\">&minus;3.240</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;1.750</td>\n<td class=\"gt_row gt_right\">0.080</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2020</td>\n<td class=\"gt_row gt_right\">&minus;3.045</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;1.645</td>\n<td class=\"gt_row gt_right\">0.100</td></tr>\n    <tr><td class=\"gt_row gt_left\">factor(season)2021</td>\n<td class=\"gt_row gt_right\">&minus;1.389</td>\n<td class=\"gt_row gt_right\">1.851</td>\n<td class=\"gt_row gt_right\">&minus;0.750</td>\n<td class=\"gt_row gt_right\">0.453</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nleague_wide_win_team %>%\n  ggplot(aes(\n    x = factor(season), \n    y = mean_point_diff, group = 1)) +\n  geom_line(aes(group = factor(home_team)), alpha = 1/2) + \n  geom_line(stat = 'summary', fun = 'mean', colour = 'blue', size = 1) +\n  labs(\n    x = \"Season\",\n    y = \"HFA\",\n    subtitle = \"Regular Season, 1999:2021\",\n    caption = \"data: nflfastR \\n Pink line is the linear trend over time\"\n  ) +\n  stat_smooth(method = 'lm', col = '#984ea3', se = FALSE, size = 1) +\n  scale_x_discrete(labels = paste0(\"'\", substr(c(1999:2021), 3, 4))) +\n  theme(axis.text.x = element_text(angle = 15, hjust = 1)) +\n  hrbrthemes::theme_ft_rc()\n```\n:::\n\n\n::: {.column-screen}\n![A full screen image](plots/linear_trend.jpg)\n:::\n\nRemoving this linear trend and focus on residuals will examine teams' performance after controlling for this decrease in hfa \n\nAverage the residuals for each team then, perform a one-sample t-test to see teams that were above or below the average HFA despite the decrease HFA over this time \n\n\n::: {.cell}\n\n```{.r .cell-code}\nleague_wide_win_team <- league_wide_win_team %>%\n  mutate(rel_hfa = resid(mod))\n\nbest_hfa <- league_wide_win_team %>% \n  group_by(home_team) %>%\n  summarise(\n    mean = mean(rel_hfa),\n    sd = sd(rel_hfa),\n    sem = sd(rel_hfa)/sqrt(n()),\n    tpval = t.test(rel_hfa)[['p.value']]\n    #tpval = t.test(rel_hfa)$p.value\n  ) %>%\n  mutate(sig = tpval < .05)\n\nbest_hfa %>%\n  gt() %>%\n  fmt_number(columns = c(2:5), decimals = 3) %>%\n  cols_label(\n    home_team = \"Home Team\",\n    mean = 'Mean',\n    sd = 'SD',\n    sem = 'SEM',\n    tpval = \"T P-val\",\n    sig = 'Sig'\n  ) \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"cawreknopf\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#cawreknopf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cawreknopf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cawreknopf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cawreknopf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cawreknopf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cawreknopf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cawreknopf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cawreknopf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cawreknopf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cawreknopf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cawreknopf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cawreknopf .gt_group_heading {\n  padding: 8px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cawreknopf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cawreknopf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cawreknopf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cawreknopf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cawreknopf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 12px;\n}\n\n#cawreknopf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cawreknopf .gt_first_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n}\n\n#cawreknopf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cawreknopf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cawreknopf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cawreknopf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cawreknopf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cawreknopf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding: 4px;\n}\n\n#cawreknopf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cawreknopf .gt_sourcenote {\n  font-size: 90%;\n  padding: 4px;\n}\n\n#cawreknopf .gt_left {\n  text-align: left;\n}\n\n#cawreknopf .gt_center {\n  text-align: center;\n}\n\n#cawreknopf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cawreknopf .gt_font_normal {\n  font-weight: normal;\n}\n\n#cawreknopf .gt_font_bold {\n  font-weight: bold;\n}\n\n#cawreknopf .gt_font_italic {\n  font-style: italic;\n}\n\n#cawreknopf .gt_super {\n  font-size: 65%;\n}\n\n#cawreknopf .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 65%;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\">Home Team</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">Mean</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">SD</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">SEM</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\">T P-val</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\">Sig</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\">ARI</td>\n<td class=\"gt_row gt_right\">&minus;2.689</td>\n<td class=\"gt_row gt_right\">5.612</td>\n<td class=\"gt_row gt_right\">1.170</td>\n<td class=\"gt_row gt_right\">0.031</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">ATL</td>\n<td class=\"gt_row gt_right\">&minus;1.113</td>\n<td class=\"gt_row gt_right\">6.373</td>\n<td class=\"gt_row gt_right\">1.329</td>\n<td class=\"gt_row gt_right\">0.411</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">BAL</td>\n<td class=\"gt_row gt_right\">5.704</td>\n<td class=\"gt_row gt_right\">5.966</td>\n<td class=\"gt_row gt_right\">1.244</td>\n<td class=\"gt_row gt_right\">0.000</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">BUF</td>\n<td class=\"gt_row gt_right\">&minus;0.645</td>\n<td class=\"gt_row gt_right\">5.273</td>\n<td class=\"gt_row gt_right\">1.100</td>\n<td class=\"gt_row gt_right\">0.564</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">CAR</td>\n<td class=\"gt_row gt_right\">&minus;1.505</td>\n<td class=\"gt_row gt_right\">7.831</td>\n<td class=\"gt_row gt_right\">1.633</td>\n<td class=\"gt_row gt_right\">0.367</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">CHI</td>\n<td class=\"gt_row gt_right\">&minus;0.885</td>\n<td class=\"gt_row gt_right\">5.788</td>\n<td class=\"gt_row gt_right\">1.207</td>\n<td class=\"gt_row gt_right\">0.471</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">CIN</td>\n<td class=\"gt_row gt_right\">&minus;2.777</td>\n<td class=\"gt_row gt_right\">6.690</td>\n<td class=\"gt_row gt_right\">1.395</td>\n<td class=\"gt_row gt_right\">0.059</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">CLE</td>\n<td class=\"gt_row gt_right\">&minus;5.936</td>\n<td class=\"gt_row gt_right\">5.377</td>\n<td class=\"gt_row gt_right\">1.121</td>\n<td class=\"gt_row gt_right\">0.000</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">DAL</td>\n<td class=\"gt_row gt_right\">1.305</td>\n<td class=\"gt_row gt_right\">6.428</td>\n<td class=\"gt_row gt_right\">1.340</td>\n<td class=\"gt_row gt_right\">0.341</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">DEN</td>\n<td class=\"gt_row gt_right\">1.247</td>\n<td class=\"gt_row gt_right\">7.145</td>\n<td class=\"gt_row gt_right\">1.490</td>\n<td class=\"gt_row gt_right\">0.412</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">DET</td>\n<td class=\"gt_row gt_right\">&minus;4.151</td>\n<td class=\"gt_row gt_right\">6.905</td>\n<td class=\"gt_row gt_right\">1.440</td>\n<td class=\"gt_row gt_right\">0.009</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">GB</td>\n<td class=\"gt_row gt_right\">5.609</td>\n<td class=\"gt_row gt_right\">6.789</td>\n<td class=\"gt_row gt_right\">1.416</td>\n<td class=\"gt_row gt_right\">0.001</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">HOU</td>\n<td class=\"gt_row gt_right\">&minus;1.863</td>\n<td class=\"gt_row gt_right\">6.101</td>\n<td class=\"gt_row gt_right\">1.364</td>\n<td class=\"gt_row gt_right\">0.188</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">IND</td>\n<td class=\"gt_row gt_right\">3.140</td>\n<td class=\"gt_row gt_right\">5.496</td>\n<td class=\"gt_row gt_right\">1.146</td>\n<td class=\"gt_row gt_right\">0.012</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">JAX</td>\n<td class=\"gt_row gt_right\">&minus;2.289</td>\n<td class=\"gt_row gt_right\">8.450</td>\n<td class=\"gt_row gt_right\">1.762</td>\n<td class=\"gt_row gt_right\">0.207</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">KC</td>\n<td class=\"gt_row gt_right\">2.079</td>\n<td class=\"gt_row gt_right\">8.307</td>\n<td class=\"gt_row gt_right\">1.732</td>\n<td class=\"gt_row gt_right\">0.243</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">LA</td>\n<td class=\"gt_row gt_right\">&minus;0.338</td>\n<td class=\"gt_row gt_right\">9.709</td>\n<td class=\"gt_row gt_right\">2.025</td>\n<td class=\"gt_row gt_right\">0.869</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">LAC</td>\n<td class=\"gt_row gt_right\">1.427</td>\n<td class=\"gt_row gt_right\">7.408</td>\n<td class=\"gt_row gt_right\">1.545</td>\n<td class=\"gt_row gt_right\">0.366</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">LV</td>\n<td class=\"gt_row gt_right\">&minus;4.105</td>\n<td class=\"gt_row gt_right\">7.413</td>\n<td class=\"gt_row gt_right\">1.546</td>\n<td class=\"gt_row gt_right\">0.014</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">MIA</td>\n<td class=\"gt_row gt_right\">&minus;1.783</td>\n<td class=\"gt_row gt_right\">6.240</td>\n<td class=\"gt_row gt_right\">1.301</td>\n<td class=\"gt_row gt_right\">0.185</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">MIN</td>\n<td class=\"gt_row gt_right\">1.745</td>\n<td class=\"gt_row gt_right\">5.338</td>\n<td class=\"gt_row gt_right\">1.113</td>\n<td class=\"gt_row gt_right\">0.131</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">NE</td>\n<td class=\"gt_row gt_right\">7.323</td>\n<td class=\"gt_row gt_right\">6.328</td>\n<td class=\"gt_row gt_right\">1.319</td>\n<td class=\"gt_row gt_right\">0.000</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">NO</td>\n<td class=\"gt_row gt_right\">1.202</td>\n<td class=\"gt_row gt_right\">7.425</td>\n<td class=\"gt_row gt_right\">1.548</td>\n<td class=\"gt_row gt_right\">0.446</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">NYG</td>\n<td class=\"gt_row gt_right\">&minus;2.592</td>\n<td class=\"gt_row gt_right\">6.353</td>\n<td class=\"gt_row gt_right\">1.325</td>\n<td class=\"gt_row gt_right\">0.063</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">NYJ</td>\n<td class=\"gt_row gt_right\">&minus;2.128</td>\n<td class=\"gt_row gt_right\">5.547</td>\n<td class=\"gt_row gt_right\">1.157</td>\n<td class=\"gt_row gt_right\">0.079</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">PHI</td>\n<td class=\"gt_row gt_right\">2.033</td>\n<td class=\"gt_row gt_right\">5.930</td>\n<td class=\"gt_row gt_right\">1.236</td>\n<td class=\"gt_row gt_right\">0.114</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">PIT</td>\n<td class=\"gt_row gt_right\">4.381</td>\n<td class=\"gt_row gt_right\">5.144</td>\n<td class=\"gt_row gt_right\">1.073</td>\n<td class=\"gt_row gt_right\">0.000</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">SEA</td>\n<td class=\"gt_row gt_right\">3.490</td>\n<td class=\"gt_row gt_right\">6.268</td>\n<td class=\"gt_row gt_right\">1.307</td>\n<td class=\"gt_row gt_right\">0.014</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n    <tr><td class=\"gt_row gt_left\">SF</td>\n<td class=\"gt_row gt_right\">&minus;0.662</td>\n<td class=\"gt_row gt_right\">7.921</td>\n<td class=\"gt_row gt_right\">1.652</td>\n<td class=\"gt_row gt_right\">0.692</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">TB</td>\n<td class=\"gt_row gt_right\">&minus;1.037</td>\n<td class=\"gt_row gt_right\">7.583</td>\n<td class=\"gt_row gt_right\">1.581</td>\n<td class=\"gt_row gt_right\">0.519</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">TEN</td>\n<td class=\"gt_row gt_right\">&minus;0.556</td>\n<td class=\"gt_row gt_right\">6.196</td>\n<td class=\"gt_row gt_right\">1.292</td>\n<td class=\"gt_row gt_right\">0.671</td>\n<td class=\"gt_row gt_center\">FALSE</td></tr>\n    <tr><td class=\"gt_row gt_left\">WAS</td>\n<td class=\"gt_row gt_right\">&minus;3.874</td>\n<td class=\"gt_row gt_right\">5.619</td>\n<td class=\"gt_row gt_right\">1.172</td>\n<td class=\"gt_row gt_right\">0.003</td>\n<td class=\"gt_row gt_center\">TRUE</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nPlot the average residuals, their SEM, colouring if they are significantly different form 0 \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# y.axis bold conditional \nbest_hfa_sort <- arrange(best_hfa, mean)                       \naxisFace <- if_else(best_hfa_sort[['sig']] == TRUE, 'bold', 'plain')\n\n# shading conditional \nabove <- best_hfa %>% \n  filter(mean > 0, sig == TRUE) %>% \n  arrange(mean)\n\naverage <- best_hfa %>% \n  filter(sig == FALSE)\n\nbelow <- best_hfa %>% \n  filter(mean < 0, sig == TRUE) %>% \n  arrange(mean)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_hfa %>%\n  ggplot(aes(\n    x = mean,\n    y = fct_reorder(home_team, mean),\n    colour = sig\n  )) +\n  geom_errorbarh(aes(\n    xmin = mean - sem,\n    xmax = mean + sem\n  )) +\n  geom_point(size = 2) +\n  scale_color_manual(\n    values = c(\"grey\", \"black\"),\n    guide = guide_legend(\n      reverse = TRUE,\n      title = \"Above/Below Average\",\n      title.position = \"top\"\n    )\n  ) +\n  scale_x_continuous(breaks = seq(-7.5, 9, 1.5)) +\n  labs(\n    x = \"Mean HFA (Residuals)\",\n    y = \"NFL Team\",\n    title = \"NFL Home Field Advantage 1999-2021\",\n    caption = \"Error bars are SEM. \\n TRUE is statistical signifance.\"\n  ) +\n  hrbrthemes::theme_ft_rc() +\n  theme(\n    axis.text.y = element_text(face = axisFace),\n    plot.title = element_text(hjust = 0.5),\n    legend.position = \"bottom\",\n    legend.key = element_rect(colour = \"transparent\", fill = \"transparent\"),\n    legend.key.width = unit(1, \"in\"),\n    legend.key.height = unit(.5, \"in\"),\n    legend.title.align = .5,\n    axis.title.x = element_text(vjust = -1)\n  ) +\n  annotate(\"rect\",\n           xmin = -Inf,\n           xmax = Inf,\n           ymax = above[['home_team']][nrow(above)],\n           ymin = above[['home_team']][1],\n           fill = \"#486e48\",\n           colour = NA,\n           alpha = 1 / 3\n  ) +\n  annotate(\"rect\",\n           xmin = -Inf,\n           xmax = Inf,\n           ymax = below[['home_team']][nrow(below)],\n           ymin = below[['home_team']][1],\n           fill = \"#346991\",\n           colour = NA,\n           alpha = 1 / 3\n  ) +\n  annotate(\"text\", x = -.1, y = above[['home_team']][3], label = \"Best Teams\") +\n  annotate(\"text\", x = .1, y = below[['home_team']][3], label = \"Worst Teams\")\n```\n:::\n\n\n::: {.column-screen}\n![A full screen image](plots/hfa_sig_test.jpg)\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# league wide\nleague_win <- pbp %>%\n  distinct(game_id, .keep_all = TRUE) %>%\n  mutate(score_diff = home_score - away_score) %>%\n  group_by(season) %>%\n  summarise(\n    n = n(),\n    home_win = mean(home_score - away_score > 0),\n    home_points_diff = sum(home_score - away_score)\n    ) %>% \n  mutate(\n    mean_point_diff = home_points_diff / n\n    )\n\n#season, week wide\nweekly_team_win <- pbp %>%\n  distinct(game_id, .keep_all = TRUE) %>%\n  mutate(score_diff = home_score - away_score) %>%\n  group_by(season, week, home_team) %>%\n  summarise(\n    away_team,\n    home_win = mean(home_score - away_score > 0),\n    home_result = sum(home_score - away_score),\n    .groups = \"drop\"\n  ) \n\nweekly_team_win1 <- pbp %>%\n  distinct(game_id, .keep_all = TRUE) %>%\n  mutate(score_diff = home_score - away_score) %>%\n  group_by(season, week) %>%\n  summarise(\n    team = home_team,\n    n = n(),\n    home_win = mean(home_score - away_score > 0),\n    home_points_diff = sum(home_score - away_score),\n    .groups = \"drop\"\n  ) %>% \n  mutate(\n    mean_point_diff = home_points_diff / n,\n    week_n = row_number()\n  ) \n```\n:::\n\n\n```\ndata{\n  int<lower=1> N_games; // number of games\n  int<lower=1> N_teams; // number of teams\n  int<lower=1,upper=N_teams> home_team[N_games]; // home team ID\n  int<lower=1,upper=N_teams> away_team[N_games]; // away team ID\n  \n  vector[N_games] score; // home point differential\n}\n\nparameters{\n  // hierarchical parameters\n  real alpha_mean;\n  real<lower=0> alpha_sigma;\n  \n  // team skill variance\n  real<lower=0> mu_sigma;\n  \n  // observation variance\n  real<lower=0> score_sigma;\n  \n  // HFA and skill vectors\n  vector[N_teams] alpha_raw;\n  vector[N_teams] mu;\n}\n\ntransformed parameters{\n  vector[N_teams] alpha;\n  // centered parameterization helps mixing of alpha_sigma a lot\n  alpha = alpha_mean + alpha_raw*alpha_sigma;\n\n}\n\nmodel{\n  vector[N_games] score_mean;\n  score_mean = alpha[home_team] + mu[home_team] - mu[away_team]; //mean for each game\n  \n  //currently using STAN default priors, uncomment to change\n  //alpha_mean ~ normal(0,10);\n  //alpha_sigma ~ normal(0,10);\n  alpha_raw ~ std_normal();\n  \n\n  //mu_sigma ~ normal(0,10);\n  mu ~ normal(0,mu_sigma);\n  \n  score ~ normal(score_mean,score_sigma);\n}\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(mc.cores = parallel::detectCores())\n\nweekly_team_win <- pbp %>%\n  distinct(game_id, .keep_all = TRUE) %>%\n  mutate(score_diff = home_score - away_score) %>%\n  group_by(season, week, home_team) %>%\n  summarise(\n    away_team,\n    home_win = mean(home_score - away_score > 0),\n    home_result = sum(home_score - away_score),\n    .groups = \"drop\"\n  ) \n\nteam_vars <- distinct(weekly_team_win, home_team) %>% pull()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfits <- lapply(1999:2021,function(y){\n  year <- y\n  stan_df <- weekly_team_win %>% \n    filter(\n      season == year #, location == \"Home\"\n      )\n  stan_list <- list(\n      N_games = stan_df %>% nrow,\n      N_teams = 32,\n      home_team = stan_df %>% \n        pull(home_team) %>% match(team_vars),\n      away_team = stan_df %>% \n        pull(away_team) %>% match(team_vars),\n      score = stan_df %>% \n        pull(home_result)\n    )\n  \n    fit <- stan('posts/nfl_hfa/season_model.stan',\n                data = stan_list,\n                iter = 2000,\n                chains = 3,\n                control = list(adapt_delta = 0.99),\n                pars = c(\"score_mean\"),\n                include = FALSE)\n    fit\n})\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!dir.exists(\"posts/nfl_hfa/output\")) dir.create(\"posts/nfl_hfa/output\")\nsave(team_vars, fits, file = \"posts/nfl_hfa/output/team_effects_default_priors.Rdata\")\n\nload(\"output/team_effects_default_priors.Rdata\")\n\nstan_home_results <- map_df(1999:2021,function(y){\n  fit <- fits[[y-1998]]\n  output <- summary(fit,pars = c(\"alpha\",\"alpha_mean\",\"alpha_sigma\"))$summary %>%\n    as_tibble(rownames = \"parameter\") %>%\n    mutate(season = y,\n           team = c(team_vars,\"ALL\",\"ALL\"))\n  output\n})\n\nwrite_csv(stan_home_results, \"stan_home_results.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstan_home_results <- read_csv('stan_home_results.csv')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#all teams HFA by season and team\n\nstan_home_results %>%\n  left_join(nflfastR::teams_colors_logos, by = c(\"team\" = \"team_abbr\")) %>%\n  mutate(\n    # LV colour is grey so I am using their secondary colour here\n    team_color = ifelse(team_color == \"#a5acaf\", \"#000000\", team_color),\n    season_label = paste0(\"'\", substr(season, 3, 4)),\n    season_label = as_factor(season_label)\n  ) %>%\n  filter(!(team %in% \"ALL\")) %>%\n  ggplot(aes(\n    x = fct_reorder(season_label, season),\n    # x = season,\n    y = mean,\n    group = team,\n    colour = team_color\n  )) +\n  geom_line(size = 1.15) +\n  scale_x_discrete(labels = paste0(\"'\", substr(c(1999:2021), 3, 4))) +\n  #scale_x_discrete(breaks = c(\"'99\", \"'01\", \"'03\", \"'05\", \"'07\", \"'09\", \"'11\", \"'13\", \"'15\", \"'17\", \"'19\", \"'21\")) +\n  gghighlight(use_direct_label = FALSE, keep_scales = TRUE) +\n  scale_color_identity(aesthetics = c(\"color\", \"fill\")) +\n  facet_wrap(vars(team), scales = \"free\", ncol = 5L) +\n  labs(\n    x = \"Season\",\n    y = \"HFA\",\n    title = \"HFA By Team\",\n    subtitle = \"Regular Season, 1999:2021\",\n    caption = \"data: nflfastR\"\n  ) +\n  becausejustynfun::white_theme() +\n  theme(axis.text = element_text(size = 6))\n```\n:::\n\n\n::: {.column-screen}\n![A full screen image](plots/stan_team_hfa.jpg)\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#best and worst\nstan_home_results %>%\n  left_join(nflfastR::teams_colors_logos, by = c(\"team\" = \"team_abbr\")) %>%\n  filter(team != \"ALL\") %>%\n  group_by(season) %>%\n  mutate(mean_rank = rank(mean), n = n()) %>%\n  filter(mean_rank %in% c(1, 32)) %>%\n  mutate(\n    hfa_bw = case_when(\n      mean_rank == 1 ~ \"Worst\",\n      mean_rank == 32 ~ \"Best\"\n      )) %>%\n  ggplot(aes(x = season, y = mean, color = hfa_bw)) +\n  geom_line() +\n  ggimage::geom_image(aes(image = team_logo_wikipedia, color = NULL), size = 0.05, by = \"width\") +\n  becausejustynfun::white_theme() +\n  #theme_bw() +\n  scale_color_brewer(palette = \"Set2\") +\n  theme(legend.position = \"bottom\") +\n  labs(\n    colour = \"HFA Rank\", \n    x = \"Season\", \n    y = \"HFA (Points)\",\n    title = \"Best & Worst Home-Field Advantage by \\nSeason\"\n    ) \n```\n:::\n\n\n::: {.column-screen}\n![A full screen image](plots/league_hfa.jpg)\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstan_table_df <- stan_home_results %>%\n  filter(\n    parameter != \"alpha_sigma\", \n    parameter != \"alpha_mean\"\n    ) %>%\n  group_by(team) %>%\n  summarise(\n    sd = sd(mean), \n    mean = mean(mean)\n    ) %>%\n  arrange(-mean) %>%\n  left_join(select(nflfastR::teams_colors_logos, team = team_abbr, team_logo_espn), by = \"team\") %>%\n  select(team_logo_espn, team, mean, sd)\n\nstan_table_df %>%\n  gt() %>%\n  gtExtras::gt_img_rows(team_logo_espn) %>%\n  tab_spanner(\n    label = \"HFA\",\n    columns = c(mean, sd)\n  ) %>%\n  cols_label(\n    team_logo_espn = \"\",\n    team = md(\"**Team**\"),\n    mean = md(\"**Mean**\"),\n    sd = md(\"**SD**\")\n  ) %>%\n  fmt_number(columns = c(3, 4), decimals = 2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"kslebxzocx\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#kslebxzocx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kslebxzocx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kslebxzocx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kslebxzocx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kslebxzocx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kslebxzocx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kslebxzocx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kslebxzocx .gt_group_heading {\n  padding: 8px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kslebxzocx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kslebxzocx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kslebxzocx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kslebxzocx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kslebxzocx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 12px;\n}\n\n#kslebxzocx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kslebxzocx .gt_first_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kslebxzocx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kslebxzocx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding: 4px;\n}\n\n#kslebxzocx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kslebxzocx .gt_sourcenote {\n  font-size: 90%;\n  padding: 4px;\n}\n\n#kslebxzocx .gt_left {\n  text-align: left;\n}\n\n#kslebxzocx .gt_center {\n  text-align: center;\n}\n\n#kslebxzocx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kslebxzocx .gt_font_normal {\n  font-weight: normal;\n}\n\n#kslebxzocx .gt_font_bold {\n  font-weight: bold;\n}\n\n#kslebxzocx .gt_font_italic {\n  font-style: italic;\n}\n\n#kslebxzocx .gt_super {\n  font-size: 65%;\n}\n\n#kslebxzocx .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 65%;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\"><strong>Team</strong></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\">\n        <span class=\"gt_column_spanner\">HFA</span>\n      </th>\n    </tr>\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\"><strong>Mean</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\"><strong>SD</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/bal.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">BAL</td>\n<td class=\"gt_row gt_right\">3.03</td>\n<td class=\"gt_row gt_right\">1.55</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/gb.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">GB</td>\n<td class=\"gt_row gt_right\">2.89</td>\n<td class=\"gt_row gt_right\">1.62</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/ne.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">NE</td>\n<td class=\"gt_row gt_right\">2.81</td>\n<td class=\"gt_row gt_right\">1.52</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/sea.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">SEA</td>\n<td class=\"gt_row gt_right\">2.75</td>\n<td class=\"gt_row gt_right\">1.47</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/pit.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">PIT</td>\n<td class=\"gt_row gt_right\">2.57</td>\n<td class=\"gt_row gt_right\">1.42</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/dal.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">DAL</td>\n<td class=\"gt_row gt_right\">2.55</td>\n<td class=\"gt_row gt_right\">1.54</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/min.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">MIN</td>\n<td class=\"gt_row gt_right\">2.53</td>\n<td class=\"gt_row gt_right\">1.64</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/ind.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">IND</td>\n<td class=\"gt_row gt_right\">2.52</td>\n<td class=\"gt_row gt_right\">1.15</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/lar.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">LA</td>\n<td class=\"gt_row gt_right\">2.44</td>\n<td class=\"gt_row gt_right\">1.86</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/no.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">NO</td>\n<td class=\"gt_row gt_right\">2.41</td>\n<td class=\"gt_row gt_right\">2.20</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/sf.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">SF</td>\n<td class=\"gt_row gt_right\">2.41</td>\n<td class=\"gt_row gt_right\">1.82</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/buf.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">BUF</td>\n<td class=\"gt_row gt_right\">2.32</td>\n<td class=\"gt_row gt_right\">1.52</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/den.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">DEN</td>\n<td class=\"gt_row gt_right\">2.32</td>\n<td class=\"gt_row gt_right\">1.50</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/ten.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">TEN</td>\n<td class=\"gt_row gt_right\">2.29</td>\n<td class=\"gt_row gt_right\">1.44</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/kc.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">KC</td>\n<td class=\"gt_row gt_right\">2.29</td>\n<td class=\"gt_row gt_right\">1.87</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/phi.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">PHI</td>\n<td class=\"gt_row gt_right\">2.28</td>\n<td class=\"gt_row gt_right\">1.44</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/lac.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">LAC</td>\n<td class=\"gt_row gt_right\">2.27</td>\n<td class=\"gt_row gt_right\">1.44</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/chi.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">CHI</td>\n<td class=\"gt_row gt_right\">2.24</td>\n<td class=\"gt_row gt_right\">1.19</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/hou.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">HOU</td>\n<td class=\"gt_row gt_right\">2.21</td>\n<td class=\"gt_row gt_right\">1.19</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/ari.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">ARI</td>\n<td class=\"gt_row gt_right\">2.19</td>\n<td class=\"gt_row gt_right\">1.63</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/tb.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">TB</td>\n<td class=\"gt_row gt_right\">2.12</td>\n<td class=\"gt_row gt_right\">1.50</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/nyj.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">NYJ</td>\n<td class=\"gt_row gt_right\">2.09</td>\n<td class=\"gt_row gt_right\">1.21</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500-dark/car.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">CAR</td>\n<td class=\"gt_row gt_right\">2.06</td>\n<td class=\"gt_row gt_right\">1.87</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/jax.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">JAX</td>\n<td class=\"gt_row gt_right\">2.06</td>\n<td class=\"gt_row gt_right\">1.37</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/cin.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">CIN</td>\n<td class=\"gt_row gt_right\">1.94</td>\n<td class=\"gt_row gt_right\">1.54</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/det.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">DET</td>\n<td class=\"gt_row gt_right\">1.94</td>\n<td class=\"gt_row gt_right\">2.16</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/mia.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">MIA</td>\n<td class=\"gt_row gt_right\">1.93</td>\n<td class=\"gt_row gt_right\">1.37</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/atl.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">ATL</td>\n<td class=\"gt_row gt_right\">1.93</td>\n<td class=\"gt_row gt_right\">1.38</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/nyg.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">NYG</td>\n<td class=\"gt_row gt_right\">1.75</td>\n<td class=\"gt_row gt_right\">1.42</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/lv.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">LV</td>\n<td class=\"gt_row gt_right\">1.72</td>\n<td class=\"gt_row gt_right\">1.29</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/cle.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">CLE</td>\n<td class=\"gt_row gt_right\">1.62</td>\n<td class=\"gt_row gt_right\">0.91</td></tr>\n    <tr><td class=\"gt_row gt_left\"><img src=\"https://a.espncdn.com/i/teamlogos/nfl/500/wsh.png\" style=\"height:30px;\"></td>\n<td class=\"gt_row gt_left\">WAS</td>\n<td class=\"gt_row gt_right\">1.57</td>\n<td class=\"gt_row gt_right\">1.20</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}